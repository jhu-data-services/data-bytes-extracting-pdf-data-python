<!DOCTYPE html>
<html lang="en"><head>
<script src="Extracting Data from PDFs with Python_files/libs/clipboard/clipboard.min.js"></script>
<script src="Extracting Data from PDFs with Python_files/libs/quarto-html/tabby.min.js"></script>
<script src="Extracting Data from PDFs with Python_files/libs/quarto-html/popper.min.js"></script>
<script src="Extracting Data from PDFs with Python_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Extracting Data from PDFs with Python_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Extracting Data from PDFs with Python_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Extracting Data from PDFs with Python_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Extracting Data from PDFs with Python_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Lubov McKone">
  <title>Extracting Data from PDFs with Python</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Extracting Data from PDFs with Python_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Extracting Data from PDFs with Python_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Extracting Data from PDFs with Python_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="/images/bg_3.png" data-background-opacity="0.4" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">Extracting Data from PDFs with Python</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Lubov McKone 
</div>
<div class="quarto-title-author-email">
<a href="mailto:lmckone1@jh.edu">lmckone1@jh.edu</a>
</div>
        <p class="quarto-title-affiliation">
            Data Services
          </p>
    </div>
</div>

</section>
<section id="section" class="slide level2">
<h2></h2>

<img data-src=".\images/db-fall.png" class="r-stretch"></section>
<section id="a-brief-history-of-pdfs" class="slide level2">
<h2>A brief history of PDFs 📃</h2>
<ul>
<li class="fragment"><strong>P</strong>ortable <strong>D</strong>ocument <strong>F</strong>ormat - released by Adobe in 1993</li>
<li class="fragment">Developed with the idea that every document should be readable and <strong>printable</strong> on <strong>any device</strong> while preserving the fidelity of the content</li>
</ul>
<aside class="notes">
<ul>
<li><p>I promise I won’t bore you with too long about the history of PDFs, because I know that’s not why you signed up for this training​</p></li>
<li><p>We’re going to be essentially taking apart PDFs in the demo today, so it will be useful to have some baseline context about what PDFs are and why they’re built that why​</p></li>
<li><p>(Read bullet 1)​</p></li>
<li><p>(Read bullet 2)​</p></li>
<li><p>There are two things to note here:​</p></li>
<li><p>First, since PDFs were developed to preserve and protect the content and layout of documents, it can sometimes be challenging to edit or extract information from them.​</p></li>
<li><p>Second, PDFs were designed for printing – they were created at a time when digital documents were designed in ways that made them easy to translate to the physical page. This is not how we expect digital text to behave now, so it’s important to keep in mind that any data we find in PDFs is designed to exist on a page, and this can present some challenge when we try to transform it into data.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-brief-history-of-pdfs-1" class="slide level2">
<h2>A brief history of PDFs 📃</h2>
<ul>
<li class="fragment">Grew in popularity from the 1990s to 2000s, became an <strong>open format</strong> in 2008</li>
<li class="fragment">Multiple standards have developed under the PDF format, and not all PDFs are alike when it comes to working with them</li>
</ul>
<aside class="notes">
<ul>
<li><p>(Read bullet 1)​</p></li>
<li><p>PDF is now an open format maintained by the ISO (International Organization for Standardization) and is no longer owned by Adobe. This means it can be opened in more software than just Adobe. ​</p></li>
<li><p>(Read bullet 2)​</p></li>
<li><p>Different types of PDFs require different ways of working with them, particularly when searching or extracting text, like we’ll be doing today.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="types-of-pdfs" class="slide level2">
<h2>3 types of PDFs</h2>
<p><strong>“True” or digitally created PDFs</strong></p>
<p>These are PDFs created digitally using software such as Microsoft Word. They consist of searchable text and images.</p>

<img data-src="images/true_pdf.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="types-of-pdfs-1" class="slide level2">
<h2>3 types of PDFs</h2>
<p><strong>“Image-only” or scanned PDFs</strong></p>
<p>These are PDFs that are created by scanning or photographing hard copy documents. They contain only the scanned/photographed images of pages and are not automatically searchable.</p>

<img data-src="images/scanned_pdf.png" class="quarto-figure quarto-figure-center r-stretch"><aside class="notes">
<ul>
<li>This is typically what we’ll see with historical research or primary source-based research</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="types-of-pdfs-2" class="slide level2">
<h2>3 types of PDFs</h2>
<p><strong>Searchable or OCRed PDFs</strong></p>
<p>These are the result of applying Optical Character Recognition (OCR) to image-only PDFs. The resulting PDF has two layers – one with the page image, and the other containing the recognized text.</p>

<img data-src="images/ocr_pdf.png" class="quarto-figure quarto-figure-center r-stretch"><aside class="notes">
<ul>
<li><p>(Read slide)</p></li>
<li><p>We’re not going to talk a lot about OCR today because it could be it’s own training.</p></li>
<li><p>OCR is a form of computer vision (“AI”) that can extract digital text from images</p></li>
<li><p>There are many products, tools, and software that perform OCR to varying levels of accuracy</p></li>
<li><p>When it comes to PDFs, some OCR products can detect the proper order of text in columns, boxes, or other layouts, while some cannot.</p></li>
<li><p>When you’re working with an OCRed PDF, you’re limited not only by the OCR output, but also by how well the tool you’re working with is able to interpret that output… more on that later.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pdfs-as-data" class="slide level2">
<h2>PDFs as data</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>What can be extracted from PDFs?</p>
<ul>
<li class="fragment">Text</li>
<li class="fragment">Images</li>
<li class="fragment">Structured data (tables)</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/pdf_data.PNG" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
<aside class="notes">
<ul>
<li>Open up the 1973 Imperial Oil report, describe where the reports come from and what they are, why someone might use them for research</li>
<li>Ask what type of data could be extracted from it in the chat</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-word-on-libraries" class="slide level2">
<h2>A word on libraries 📚</h2>
<p>There are several libraries for working with PDFs in Python that do many of the same things. During this training we’ll be comparing their performance for different tasks:</p>
<ul>
<li class="fragment"><p><code>pdfplumber</code></p></li>
<li class="fragment"><p><code>pyPDF</code></p></li>
<li class="fragment"><p><code>PyMuPDF</code></p></li>
</ul>
</section>
<section id="pdfs-as-data-1" class="slide level2">
<h2>PDFs as data 📊</h2>
<ul>
<li class="fragment"><p>To Python, every PDF is made up of two components: the document metadata and a set of pages.</p></li>
<li class="fragment"><p>Each page consists of objects that can be classified as:</p>
<ul>
<li class="fragment"><p>characters</p></li>
<li class="fragment"><p>lines</p></li>
<li class="fragment"><p>rectangles</p></li>
<li class="fragment"><p>curves</p></li>
<li class="fragment"><p>images</p></li>
<li class="fragment"><p>and metadata about each of these objects</p></li>
</ul></li>
</ul>
<aside class="notes">
<ul>
<li><p>Read slide</p></li>
<li><p>Let’s take a took at what I mean using our first library, <code>pdfplumber</code></p></li>
<li><p>Open up a new jupyter notebook</p></li>
<li><p><code>import pdfplumber</code></p>
<p><code>with pdfplumber.open("../Data/Imperial Oil Annual Report 1973.pdf") as pdfplumber_1973:</code></p>
<p><code>print(pdfplumber_1973.metadata) print(pdfplumber_1973.pages)</code></p></li>
<li><p>If we call the metadata attribute and the pages attribute, we can see some information about how this PDF was created and we can see that there are 15 pages, which Python stores as a list of Page objects. The Page object is defined by the library that is reading the pdf.</p></li>
<li><p>We see that the document is stored as a list of pages. What happens if we look at the first one?</p></li>
<li><p><code>print(pdfplumber_1973.pages[0])</code></p></li>
<li><p>Not very informative! This just shows us that the page is stored in a Page object, defined by pdfplumber. These page objects have a number of methods and attributes.</p></li>
<li><p><code>print(pdfplumber_1973.pages[0].page_number)</code><br>
<code>print(pdfplumber_1973.pages[0].width)</code><br>
<code>print(pdfplumber_1973.pages[0].height)</code></p></li>
<li><p><code>with pdfplumber.open("../Data/Imperial Oil Annual Report 1973.pdf") as pdfplumber_1973: print(pdfplumber_1973.pages[0].objects)</code></p></li>
<li><p>Go over the objects, particularly the characters, and discuss the visual way PDFs encode information</p></li>
<li><p>this is <code>pdfplumber</code> ’s “raw” interpretation of what is on the page. While we could technically interpret and work with this raw json, all of the packages we’re going to look at today have helpful functions (methods) that extract what you want for you!</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="extracting-text-from-pdfs" class="slide level2">
<h2>Extracting text from PDFs 🔡</h2>
<p>Goal: Extract the text from the 1973 Imperial Oil Report</p>
<p>Some questions:</p>
<ul>
<li class="fragment"><p>Will the text be extracted left to right across the page, or by column?</p></li>
<li class="fragment"><p>How can we combine the text from all of the pages?</p></li>
</ul>
<aside class="notes">
<ul>
<li><p>Let’s continue working with <code>pdfplumber</code> to extract our text. One of those “helper functions” I mentioned is <code>extract_text()</code></p></li>
<li><p><code>with pdfplumber.open("../Data/Imperial Oil Annual Report 1973.pdf") as pdfplumber_1973: print(pdfplumber_1973.pages[1].extract_text())</code></p></li>
<li><p>It doesn’t look great!</p></li>
<li><p>A couple of things to note:</p>
<ul>
<li><p>This pdf is from 1973. It is over 50 years old. It has been OCRed</p></li>
<li><p><code>pdfplumber</code> is looking line by line at the pdf, and is not interpreting any info that may be encoded in the OCR about the sequencing of the text</p></li>
<li><p>Going back to what I said earlier, your extracting capabilities will be limited by both the OCR and the package you are working with. So let’s see if we can’t get a better result with another package.</p></li>
</ul></li>
<li><p><code>import pymupdfpymupdf_1973 = pymupdf.open("../Data/Imperial Oil Annual Report 1973.pdf")print(pymupdf_1973[1].get_text())</code></p></li>
<li><p>This package is recognizing the layout of the document! We still have some weird spacing issues, so let’s try one more library.</p></li>
<li><p><code>from pypdf import PdfReaderpypdf_1973 = PdfReader("../Data/Imperial Oil Annual Report 1973.pdf")print(pypdf_1973.pages[1].extract_text())</code></p></li>
<li><p>This is our best result yet. It’s important to look at your results and compare them. But we notice that we still have some weird linebreaks. These exist because as I mentioned, PDFs are designed to exist the same way on every page</p></li>
<li><p><code>print(pypdf_1973.pages[1].extract_text().replace("</code><code>", ""))</code></p></li>
<li><p>Finally, we’ve just extracted the first page of text. We can use a for loop too extract text from the whole document.</p></li>
<li><p><code>document_text = ''</code></p>
<p><code>for page in pypdf_1973.pages: page_text = page.extract_text().replace("</code><code>", "") document_text += page_text print(document_text)</code></p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="code-for-extracting-text" class="slide level2">
<h2>Code for extracting text</h2>
<div id="69bda0f4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="co"># Extracting text with pdfplumber</span></span>
<span id="cb1-2"><a href=""></a><span class="cf">with</span> pdfplumber.<span class="bu">open</span>(<span class="st">"../Data/Imperial Oil Annual Report 1973.pdf"</span>) <span class="im">as</span> pdfplumber_1973: </span>
<span id="cb1-3"><a href=""></a>  <span class="bu">print</span>(pdfplumber_1973.pages[<span class="dv">1</span>].extract_text())</span>
<span id="cb1-4"><a href=""></a></span>
<span id="cb1-5"><a href=""></a><span class="co"># Extracting text with pymupdf</span></span>
<span id="cb1-6"><a href=""></a><span class="im">import</span> pymupdf</span>
<span id="cb1-7"><a href=""></a>pymupdf_1973 <span class="op">=</span> pymupdf.<span class="bu">open</span>(<span class="st">"../Data/Imperial Oil Annual Report 1973.pdf"</span>)</span>
<span id="cb1-8"><a href=""></a><span class="bu">print</span>(pymupdf_1973[<span class="dv">1</span>].get_text())</span>
<span id="cb1-9"><a href=""></a></span>
<span id="cb1-10"><a href=""></a><span class="co"># Extracting text with pypdf</span></span>
<span id="cb1-11"><a href=""></a><span class="im">from</span> pypdf <span class="im">import</span> PdfReader</span>
<span id="cb1-12"><a href=""></a>pypdf_1973 <span class="op">=</span> PdfReader(<span class="st">"../Data/Imperial Oil Annual Report 1973.pdf"</span>)</span>
<span id="cb1-13"><a href=""></a>document_text <span class="op">=</span> <span class="st">''</span></span>
<span id="cb1-14"><a href=""></a><span class="co"># loop over the pages </span></span>
<span id="cb1-15"><a href=""></a><span class="cf">for</span> page <span class="kw">in</span> pypdf_1973.pages: </span>
<span id="cb1-16"><a href=""></a>  <span class="co"># remove newlines from extracting text </span></span>
<span id="cb1-17"><a href=""></a>  page_text <span class="op">=</span> page.extract_text().replace(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">""</span>) </span>
<span id="cb1-18"><a href=""></a>  document_text <span class="op">+=</span> page_text </span>
<span id="cb1-19"><a href=""></a><span class="bu">print</span>(document_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-text-from-pdfs---summary" class="slide level2">
<h2>Extracting text from PDFs - summary</h2>
<ul>
<li class="fragment"><p>Libraries for text extraction:</p>
<ul>
<li class="fragment"><p><code>pdfplumber</code> - has nice filtering features and great documentation, but processes text line-by-line so not great for multi-column spreads.</p></li>
<li class="fragment"><p><code>pyPDF</code> - great library for high-quality basic text extraction.</p></li>
<li class="fragment"><p><code>pyMuPDF</code> - similar to pyPDF with varying accuracy, so good to check both.</p></li>
</ul></li>
</ul>
</section>
<section id="extracting-text-from-pdfs---tips" class="slide level2">
<h2>Extracting text from PDFs - tips 👉</h2>
<ul>
<li class="fragment"><p>Check your results! Compare ouputs across libraries.</p></li>
<li class="fragment"><p>Make sure your output reflects the layout of the text, and doesn’t just scan left to right.</p></li>
<li class="fragment"><p>PDFs often contain hidden newlines to preserve the layout of the text, so keep an eye out for strange line breaks and remove <code>\n</code> characters if necessary.</p></li>
<li class="fragment"><p>Loop over pages to combine document text.</p></li>
</ul>
</section>
<section id="extracting-images-from-pdfs" class="slide level2">
<h2>Extracting images from PDFs 🖼️</h2>
<ul>
<li class="fragment"><p>Because our old document was OCRed, we were able to extract at least some text from it</p></li>
<li class="fragment"><p>However, OCR doesn’t extract images - if you remember, for OCRed documents, the entire page actually has two layers, the page image and the OCRed text - so if we tried to extract images, we’d just get the full page images.</p></li>
<li class="fragment"><p>For image detection, we’re limited to working with digital PDFs - such as the 2023 Imperial Oil Annual Report</p></li>
</ul>
<aside class="notes">
<ul>
<li><p>Open up Imperial Oil 2023 report</p></li>
<li><p><code>pypdf_2023 = PdfReader("../../Data/Imperial Oil Annual Report 2023.pdf")</code></p>
<p><code>for page in pypdf_2023.pages:   for count, image_file_object in enumerate(page.images):      with open(str(count) + image_file_object.name, "wb") as fp:         fp.write(image_file_object.data)      display(Image(filename = str(count) + image_file_object.name, width=10))</code></p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="code-for-extracting-images" class="slide level2">
<h2>Code for extracting images</h2>
<div id="edea97b1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="co"># read in the document with pypdf</span></span>
<span id="cb2-2"><a href=""></a>pypdf_2023 <span class="op">=</span> PdfReader(<span class="st">"../../Data/Imperial Oil Annual Report 2023.pdf"</span>)</span>
<span id="cb2-3"><a href=""></a></span>
<span id="cb2-4"><a href=""></a><span class="cf">for</span> page <span class="kw">in</span> pypdf_2023.pages:</span>
<span id="cb2-5"><a href=""></a>  <span class="co"># loop over the images </span></span>
<span id="cb2-6"><a href=""></a>  <span class="cf">for</span> count, image_file_object <span class="kw">in</span> <span class="bu">enumerate</span>(page.images):</span>
<span id="cb2-7"><a href=""></a>    <span class="co"># write each image to a .jpg file</span></span>
<span id="cb2-8"><a href=""></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="bu">str</span>(count) <span class="op">+</span> image_file_object.name, <span class="st">"wb"</span>) <span class="im">as</span> fp:</span>
<span id="cb2-9"><a href=""></a>      fp.write(image_file_object.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-tables-from-pdfs" class="slide level2">
<h2>Extracting tables from PDFs 📅</h2>
<p>Some of these libraries can actually detect and extract tables from PDFs! This feature also performs best on digital PDFs, and doesn’t always detect things that we as humans know to be tables.</p>
<p>The best implementaton by far is in <code>PyMuPDF</code> - let’s give it a try on a <a href="https://data.baltimorecity.gov/documents/aa87fd9ed6124db2b1c2aed8a5bf21cd/about">Baltimore Police Department Weekly Incident Report</a> from <a href="https://data.baltimorecity.gov/">Open Baltimore</a>.</p>
<aside class="notes">
<ul>
<li><p>Open up the report in a browser window</p></li>
<li><p>Talk about why a researcher might want this data in tabular format rather than pdfs</p>
<ul>
<li><p>Easier to analyze</p></li>
<li><p>The data is by week - by digitizing it, we can combine it and analyze longer periods</p></li>
</ul></li>
<li><p>Show that copying and pasting the report into Excel doesn’t go well</p></li>
<li><p>Scroll through the report and say that we are just going to focus on the first page because we are concerned with citywide statistics</p></li>
<li><p>And the first table on the first page because we’re not interested in the domestic-related crimes specifically</p></li>
<li><p><code>police_report = pymupdf.open("../Data/police_report_week12.pdf")</code><br>
<code>page = police_report[0]</code><br>
<code>tabs = page.find_tables()</code><br>
<code>print(tabs)</code></p>
<p><code>df = tabs[0].to_pandas()</code></p>
<p><code>df</code></p></li>
<li><p>As we can see, the table reader wasn’t able to detect the header fields. Let’s see if there’s anything else on the page we can use to create the header variables. We can use good-old text extraction to start.</p></li>
<li><p><code>page_text = page.get_text()</code><br>
<code>print(page_text)</code></p></li>
<li><p>Everything is a bit out of order… but we know a couple things about how our document is structured that can help us set up the headers</p></li>
<li><p>The variable part here across documents will be the actual dates, so lets extract those and start building our header from there.</p></li>
<li><p><code>table_dates = page_text[page_text.find("YEAR TO DATE")+len("YEAR TO DATE"):page_text.find("%")].split()print(table_dates)</code></p></li>
<li><p>Go to the document and show that the header is crime type, two 7-day counts, the 7-day percent change, two 28-day counts, the 28-day percent change, two YTD counts, the YTD percent change.</p></li>
<li><p><code>header_list = ["Crime type", table_dates[0] + "-" + table_dates[1], table_dates[2] + "-" + table_dates[3], "7-day percent change", table_dates[4] + "-" + table_dates[5], table_dates[6] + "-" + table_dates[7], "28-day percent change", table_dates[8] + "-" + table_dates[9], table_dates[10] + "-" + table_dates[11], "YTD percent change"]</code></p>
<p><code>print(header_list)</code></p></li>
<li><p>Now all we have to do is assign the header to our table</p></li>
<li><p><code>df.columns = header_list</code></p>
<p><code>df</code></p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="code-for-extracting-tables" class="slide level2">
<h2>Code for extracting tables</h2>
<div id="9b2b249a" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a>police_report <span class="op">=</span> pymupdf.<span class="bu">open</span>(<span class="st">"../Data/police_report_week12.pdf"</span>)</span>
<span id="cb3-2"><a href=""></a>page <span class="op">=</span> police_report[<span class="dv">0</span>]</span>
<span id="cb3-3"><a href=""></a>tabs <span class="op">=</span> page.find_tables()</span>
<span id="cb3-4"><a href=""></a>df <span class="op">=</span> tabs[<span class="dv">0</span>].to_pandas()</span>
<span id="cb3-5"><a href=""></a></span>
<span id="cb3-6"><a href=""></a>page_text <span class="op">=</span> page.get_text()</span>
<span id="cb3-7"><a href=""></a></span>
<span id="cb3-8"><a href=""></a>table_dates <span class="op">=</span> page_text[page_text.find(<span class="st">"YEAR TO DATE"</span>)<span class="op">+</span><span class="bu">len</span>(<span class="st">"YEAR TO DATE"</span>):page_text.find(<span class="st">"%"</span>)].split()</span>
<span id="cb3-9"><a href=""></a></span>
<span id="cb3-10"><a href=""></a>header_list <span class="op">=</span> [<span class="st">"Crime type"</span>, table_dates[<span class="dv">0</span>] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> table_dates[<span class="dv">1</span>],</span>
<span id="cb3-11"><a href=""></a>table_dates[<span class="dv">2</span>] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> table_dates[<span class="dv">3</span>],</span>
<span id="cb3-12"><a href=""></a><span class="st">"7-day percent change"</span>, table_dates[<span class="dv">4</span>] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> table_dates[<span class="dv">5</span>],</span>
<span id="cb3-13"><a href=""></a>table_dates[<span class="dv">6</span>] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> table_dates[<span class="dv">7</span>], <span class="st">"28-day percent change"</span>,</span>
<span id="cb3-14"><a href=""></a>table_dates[<span class="dv">8</span>] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> table_dates[<span class="dv">9</span>], table_dates[<span class="dv">10</span>] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> table_dates[<span class="dv">11</span>],</span>
<span id="cb3-15"><a href=""></a><span class="st">"YTD percent change"</span>]</span>
<span id="cb3-16"><a href=""></a></span>
<span id="cb3-17"><a href=""></a>df.columns <span class="op">=</span> header_list </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-tables---tips" class="slide level2">
<h2>Extracting tables - tips 👉</h2>
<ul>
<li class="fragment"><p>Check your results, including whether the header is captured</p></li>
<li class="fragment"><p>Don’t forget about text extraction!</p></li>
</ul>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li class="fragment"><p><code>pypdf</code> :</p>
<ul>
<li class="fragment"><p>best OCR interpreter for extracting text from older documents</p></li>
<li class="fragment"><p>best for extracting images</p></li>
</ul></li>
<li class="fragment"><p><code>pymupdf</code> :</p>
<ul>
<li class="fragment">best for tables</li>
</ul></li>
<li class="fragment"><p><code>pdfplumber</code> :</p>
<ul>
<li class="fragment">good package for beginners</li>
</ul></li>
</ul>
</section>
<section id="docs-and-resources" class="slide level2">
<h2>Docs and resources</h2>
<ul>
<li class="fragment"><p><a href="https://pypdf.readthedocs.io/en/stable/">pyPDF documentation</a></p></li>
<li class="fragment"><p><a href="https://pymupdf.readthedocs.io/en/latest/">PyMuPDF documentation</a></p></li>
<li class="fragment"><p><a href="https://github.com/jsvine/pdfplumber">pdfplumber documentation</a></p></li>
<li class="fragment"><p><a href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/table-analysis">Extracting Tables with PyMuPDF</a></p></li>
</ul>
</section>
<section id="thanks" class="slide level2">
<h2>Thanks!</h2>
<p>Please give us your feedback on this session at <a href="https://bit.ly/survey-data-bytes">bit.ly/survey-data-bytes</a> and join us at the next Data Bytes!</p>

<img data-src="images/db-fall.png" class="quarto-figure quarto-figure-center r-stretch"><div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>Data Bytes - Fall 2024</p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Extracting Data from PDFs with Python_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>